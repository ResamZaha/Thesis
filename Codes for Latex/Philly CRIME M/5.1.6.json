[{
    "$project": {
        "_id": 0,
        "objectid": 1,
        "location_block": 1,
        "Type": {
            "$switch": {
                "branches": [
                    {
                        "case": { "$regexMatch": { "input": "$text_general_code", "regex": "Homicide", "options": "i" } },
                        "then": "Homicide-related"
                    },
                    {
                        "case": { "$regexMatch": { "input": "$text_general_code", "regex": "Weapon", "options": "i" } },
                        "then": "Weapon-related"
                    },
                    {
                        "case": { "$regexMatch": { "input": "$text_general_code", "regex": "drunkness", "options": "i" } },
                        "then": "drunkness-related"
                    }
                ],
                "default": "Other"
            }
        },
        "IsTheft": {
            "$cond": [
                { "$regexMatch": { "input": "$text_general_code", "regex": "thefts", "options": "i" } },
                true,
                false
            ]
        },
        "dispatch_date_time": 1
    }
}]
